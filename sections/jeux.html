<style>
  .section-heading { display:flex; align-items:center; gap:10px; }
  .section-heading .icon-svg { width:28px; height:28px; transition: transform 0.18s ease; }
  .section-heading:hover .icon-svg { transform: scale(1.12); }
  .options button { transition: transform 0.12s ease, box-shadow 0.12s ease; }
  .options button:hover { transform: translateY(-3px); box-shadow: 0 8px 16px rgba(0,0,0,0.14); }
  .options button.correct { background: rgba(26,188,156,0.5) !important; }
  .options button.incorrect { background: rgba(231,76,60,0.5) !important; }
</style>
<h2 class="section-heading"><svg class="icon-svg" aria-hidden="true"><use href="#icon-game"></use></svg> <span>Quiz Biblique - 5 Niveaux</span></h2>
<p style="text-align:center; margin:10px 0; opacity:0.9;">üìö Niveau 1: Croyant (20Q) ‚Ä¢ Niveau 2: Disciple (40Q) ‚Ä¢ Niveau 3: Ouvrier (60Q) ‚Ä¢ Niveau 4: Pasteur (80Q) ‚Ä¢ Niveau 5: Docteur (100Q)</p>

<style>
  .quiz-container {
    background: rgba(255,255,255,0.05);
    border-radius: 10px;
    padding: 20px;
    max-width: 700px;
    margin: auto;
  }
  .question {
    margin: 20px 0;
    font-size: 18px;
    font-weight: 500;
  }
  .options button {
    display: block;
    width: 100%;
    margin: 8px 0;
    padding: 12px;
    border: 2px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    cursor: pointer;
    background: rgba(255,255,255,0.1);
    color: white;
    transition: all 0.3s;
    font-size: 14px;
  }
  .options button:hover:not(:disabled) {
    background: rgba(255,255,255,0.2);
    border-color: rgba(255,255,255,0.4);
  }
  .options button:disabled { cursor: not-allowed; opacity: 0.9; }
  #result {
    margin-top: 20px;
    font-size: 18px;
    font-weight: bold;
    padding: 15px;
    background: rgba(26,188,156,0.2);
    border-radius: 8px;
  }
  .progress-bar {
    width: 100%;
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
    margin: 15px 0;
    height: 20px;
    overflow: hidden;
  }
  .progress {
    height: 100%;
    background: linear-gradient(90deg, #1abc9c, #16a085);
    width: 0%;
    transition: width 0.3s;
  }
  #restartBtn {
    margin-top: 15px;
    padding: 12px 30px;
    background: linear-gradient(90deg, #6a11cb, #2575fc);
    border: none;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    font-size: 16px;
    transition: transform 0.2s;
  }
  #restartBtn:hover { transform: scale(1.05); }
</style>

<div class="quiz-container">
  <div id="quiz"></div>
  <div class="progress-bar"><div id="progress" class="progress"></div></div>
  <div id="result"></div>
  <button id="restartBtn" onclick="restartQuiz()" style="display:none;">Rejouer</button>
</div>

<script src="https://cdn.jsdelivr.net/gh/franckzeregbe/AUTOMATISATION@main/quiz-questions.js"></script>
<script>
  let currentLevel = 0;
  let currentQuestion = 0;
  let score = 0;
  let usedQuestions = [];
  let answering = false;

  function showQuestion() {
    const quizDiv = document.getElementById("quiz");
    quizDiv.innerHTML = "";

    let questions = window.quizQuestions[currentLevel];
    if(currentQuestion < questions.length) {
      const q = questions[currentQuestion];
      quizDiv.innerHTML = "<div class='question'>" + q.question + "</div>";

      const optionsDiv = document.createElement("div");
      optionsDiv.className = "options";

      q.options.forEach((opt, i) => {
        const btn = document.createElement("button");
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(i, btn);
        optionsDiv.appendChild(btn);
      });

      quizDiv.appendChild(optionsDiv);

      let progressPercent = ((currentQuestion + 1) / questions.length) * 100;
      document.getElementById("progress").style.width = progressPercent + "%";
      document.getElementById("restartBtn").style.display = "none";
    } else {
      let grade = getGrade(score, questions.length);
      let message = getMotivation(grade);
      document.getElementById("result").innerHTML =
        "Niveau " + (currentLevel + 1) + " termin√© üéâ<br>Score : " + score + "/" + questions.length +
        " | Grade : <strong>" + grade + "</strong><br>" + message;

      if(currentLevel < window.quizQuestions.length - 1) {
        document.getElementById("result").innerHTML +=
          "<br><br><small>Passage au niveau suivant dans 4 secondes...</small>";
        setTimeout(() => {
          currentLevel++;
          currentQuestion = 0;
          score = 0;
          usedQuestions = [];
          showQuestion();
        }, 4000);
      } else {
        document.getElementById("result").innerHTML +=
          "<br><br><strong>üèÜ Tous les niveaux compl√©t√©s !</strong>";
        document.getElementById("restartBtn").style.display = "block";
      }
    }
  }

  function checkAnswer(selected, btn) {
    if(answering) return;
    answering = true;

    let questions = window.quizQuestions[currentLevel];
    let correct = selected === questions[currentQuestion].answer;
    
    document.querySelectorAll(".options button").forEach(b => b.disabled = true);
    
    if(correct) {
      score++;
      btn.classList.add('correct');
      btn.innerHTML += " ‚úì";
      
      setTimeout(() => {
        usedQuestions.push(currentQuestion);
        currentQuestion++;
        answering = false;
        showQuestion();
      }, 4000);
    } else {
      btn.classList.add('incorrect');
      btn.innerHTML += " ‚úó";
      let correctBtn = document.querySelectorAll(".options button")[questions[currentQuestion].answer];
      correctBtn.classList.add('correct');
      correctBtn.innerHTML += " ‚úì (Bonne r√©ponse)";
      
      setTimeout(() => {
        let availableQuestions = [];
        for(let i = 0; i < questions.length; i++) {
          if(!usedQuestions.includes(i) && i !== currentQuestion) {
            availableQuestions.push(i);
          }
        }
        
        if(availableQuestions.length > 0) {
          currentQuestion = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
          document.getElementById("result").innerHTML = "<span style='color:#e74c3c;'>‚ùå Mauvaise r√©ponse ! Nouvelle question...</span>";
        } else {
          currentQuestion++;
        }
        
        answering = false;
        showQuestion();
      }, 4000);
    }
  }

  function restartQuiz() {
    currentLevel = 0;
    currentQuestion = 0;
    score = 0;
    usedQuestions = [];
    answering = false;
    document.getElementById("result").innerHTML = "";
    document.getElementById("progress").style.width = "0%";
    document.getElementById("restartBtn").style.display = "none";
    showQuestion();
  }

  function getGrade(score, total) {
    let percent = (score / total) * 100;
    if(percent < 60) return "Croyant";
    else if(percent < 75) return "Disciple";
    else if(percent < 85) return "Ouvrier";
    else if(percent < 95) return "Pasteur";
    else return "Docteur";
  }

  function getMotivation(grade) {
    switch(grade) {
      case "Croyant": return "Continue √† √©tudier la Parole, tu progresses ‚ú®";
      case "Disciple": return "Bonne connaissance biblique, pers√©v√®re üôè";
      case "Ouvrier": return "Tu ma√Ætrises bien les √âcritures, continue üí™";
      case "Pasteur": return "Excellente connaissance, tu peux enseigner üåü";
      case "Docteur": return "Ma√Ætrise exceptionnelle ! Tu es un √©rudit biblique üìñüî•";
      default: return "";
    }
  }

  if(typeof window.quizQuestions === 'undefined') {
    document.getElementById("quiz").innerHTML = "<p style='color:#e74c3c;'>‚ö†Ô∏è Erreur de chargement des questions. Veuillez rafra√Æchir la page.</p>";
  } else {
    showQuestion();
  }
</script>
